<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"  content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
    <script src="/socket.io/socket.io.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <style>
        .container a {
            margin: 10px 0;
        }
        .playing {
            background-color: green !important;
        }
    </style>
</head>
<body>

<section class="section">
    <div class="container">
        <a id="intro" class="button is-medium is-block is-link">
            Play 'intro' video
        </a>
        <a id="hurry" class="button is-medium is-block is-link">
            Play 'hurry up' video
        </a>
        <a id="monster1" class="button is-medium is-block is-link">
            Play 'monster echo' audio
        </a>
    </div>
</section>

<script>
    let socket = io();

    function clearPlayingVideos()
    {
        document.getElementById('intro').classList.remove('playing');
        document.getElementById('hurry').classList.remove('playing');
    }

    document.getElementById("intro").addEventListener("click", function(e){
        e.preventDefault();
        this.classList.add("is-loading");
        socket.emit('video-start', {control:'intro', file:'intro'});
    });
    document.getElementById("hurry").addEventListener("click", function(e){
        e.preventDefault();
        this.classList.add("is-loading");
        socket.emit('video-start', {control:'hurry', file:'hurry'});
    });
    document.getElementById("monster1").addEventListener("click", function(e){
        e.preventDefault();
        this.classList.add("is-loading");
        socket.emit('audio-start', {control:'monster1', file:'monster_echo'});
    });

    socket.on('video-loaded', function(data){
        document.getElementById(data.control).classList.remove('is-loading');
        clearPlayingVideos();
        document.getElementById(data.control).classList.add('playing');
    });
    socket.on('video-playing', function(data){
        document.getElementById(data.control).classList.remove('is-loading');
        clearPlayingVideos();
        document.getElementById(data.control).classList.add('playing');
    });
    socket.on('video-ended', function(data){
        clearPlayingVideos();
    });

    socket.on('audio-loaded', function(data){
        document.getElementById(data.control).classList.remove('is-loading');
        document.getElementById(data.control).classList.add('playing');
    });
    socket.on('audio-playing', function(data){
        document.getElementById(data.control).classList.remove('is-loading');
        document.getElementById(data.control).classList.add('playing');
    });
    socket.on('audio-ended', function(data){
        document.getElementById(data.control).classList.remove('playing');
    });
</script>

</body>
</html>